define(["base","app/commonApp"],function(e,t){var r=null;var a={processing:true,serverSide:true,searching:false,ordering:false,lengthChange:false,pagingType:"full_numbers",ajax:{url:$.path+"/api/portal/resource/findResResourceByPage",type:"get",contentType:"application/json",xhrFields:{withCredentials:true},data:function(r){t.gridPageFliter(r);var a=e.form.getParams($("#search-form"));var i=$("#themeName").attr("tid");var n;if($.cookie("dssgUserInfo")){var s=$.cookie("dssgUserInfo");var l=JSON.parse(s).loginUserProfileDTO.currentEquipment.token}if(a){n=$.extend({equipment:l?l:"0",page:r.page,size:r.size},a)}if(i&&i!=0){n.themeType=i}else{n.themeType=""}return n}},columns:[{data:"id",sWidth:"5%"},{data:"resName",sWidth:"15%"},{data:"resCode",sWidth:"15%"},{data:"themeName",sWidth:"14%"},{data:"industryTypeName",sWidth:"14%"},{data:"resTypeName",sWidth:"14%"},{data:"publishDept",sWidth:"11%"},{data:"hot",sWidth:"10%"}],columnDefs:[{render:function(e,t,r,a){return"<div class='checkboxWrapper'><input type='checkbox' name='cb' value='"+r.id+"' class='cb' cid='"+r.id+"'/></div>"},targets:0},{render:function(e,t,r,a){if(r.resName){var i="";if(r.resName.length>10){i=r.resName.substr(0,10)+"..."}else{i=r.resName}return"<div title='"+r.resName+"'>"+i+"</div>"}else{return"--"}},targets:1},{render:function(e,t,r,a){if(r.resCode){var i="";if(r.resCode.length>10){i=r.resCode.substr(0,10)+"..."}else{i=r.resCode}return"<div class='handCursor' title='"+r.resCode+"'>"+i+"</div>"}else{return"--"}},targets:2},{render:function(e,t,r,a){if(r.themeName){var i="";if(r.themeName.length>10){i=r.themeName.substr(0,10)+"..."}else{i=r.themeName}return"<div class='handCursor' title='"+r.themeName+"'>"+i+"</div>"}else{return"--"}},targets:3},{render:function(e,t,r,a){if(r.publishDept){var i="";if(r.industryTypeName.length>10){i=r.industryTypeName.substr(0,10)+"..."}else{i=r.industryTypeName}return"<div class='handCursor' title='"+r.industryTypeName+"'>"+i+"</div>"}else{return"--"}},targets:4},{render:function(e,t,r,a){if(r.publishDept){var i="";if(r.publishDept.length>10){i=r.publishDept.substr(0,10)+"..."}else{i=r.publishDept}return"<div class='handCursor' title='"+r.publishDept+"'>"+i+"</div>"}else{return"--"}},targets:6},{render:function(e,t,r,a){switch(r.hot){case"0":return"否";break;case"1":return"是";break}},targets:7}],drawCallback:function(r){e.selectAll($("#cball"),$(".cb"),function(){t.checkByGridButton($(".cb"))});t.selectedTr($("#hot"))}};var i=function(){r=e.datatables({container:$("#hot"),option:a,filter:t.gridFilter})};function n(){var t={name:"themeType",type:1};e.ajax({url:$.path+"/api/sysBussinessDictionary/findDictionaryByType",params:t,type:"post",success:function(t){if(JSON.stringify(t.data)=="{}"){}else{var r=[{id:"0",name:"全部",pid:"0",open:true}];var a=t.data.themeType;a.map(function(e,t){if(e.children&&e.children.length>0){e.children.map(function(t,a){if(t.children&&t.children.length>0){t.children.map(function(e,a){if(e.children&&e.children.length>0){e.children.map(function(t,a){if(t.children&&t.children.length>0){}r.push({id:t.key,name:t.label,pid:e.key})})}r.push({id:e.key,name:e.label,pid:t.key})})}r.push({id:t.key,name:t.label,pid:e.key})})}r.push({id:e.key,name:e.label,pid:"0"})});var i=e.form.treeSelect({container:$("#themeName"),data:r})}}})}var s=function(){$("#search").on("click",function(){t.search(r)})};var l=function(){$("#reset").on("click",function(){t.reset($("#search-form"),r)})};var c=function(){var a={resourceId:e.getChecks("cb")};var i=e.modal({width:700,height:270,label:"推荐设置",url:"../html/portalManage/modify.html",buttons:[{label:"保存",cls:"btn btn-info",clickEvent:function(){e.form.validate({form:$("#form"),checkAll:true,passCallback:function(){var n=e.form.getParams($("#form"));if(n){var s=$.extend(n,a);t.submit({url:$.path+"/api/portal/resource/updateResource",params:s,type:"post",callback:function(e){if(e.code==0){e.message="保存成功"}else{e.message="保存失败"}t.search(r)}});i.hide()}}})}},{label:"重置",cls:"btn btn-warning",clickEvent:function(){t.reset($("#form"))}}]})};var d=function(){$(".ui-grid-buttonbar .modify").on("click",function(){if($(this).hasClass("disabled")){return}else{c()}})};var o=function(){e.scroll({container:$(".ui-gridbar")})};return{main:function(){i();n();s();l();d();o()}}});