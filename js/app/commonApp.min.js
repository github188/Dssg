define(["base","datatables","tree","cookies"],function(e){var t=10;var a={search:function(e){e.reload()},reset:function(t,a){e.form.reset(t,function(){if(a){a.reload()}})},checkByGridButton:function(e){if(e&&e.length>0){var t=$(e).filter(":checked");if(t.length==1){$(".ui-grid-buttonbar .modify").removeClass("disabled");$(".ui-grid-buttonbar .delete").removeClass("disabled")}else if(t.length>1){$(".ui-grid-buttonbar .modify").removeClass("disabled");$(".ui-grid-buttonbar .modify").addClass("disabled");$(".ui-grid-buttonbar .delete").removeClass("disabled")}else{$(".ui-grid-buttonbar .modify").removeClass("disabled");$(".ui-grid-buttonbar .modify").addClass("disabled");$(".ui-grid-buttonbar .delete").removeClass("disabled");$(".ui-grid-buttonbar .delete").addClass("disabled")}}},submit:function(t){var r=t.url?t.url:"";var i=t.params?t.params:null;var n=t.callback?t.callback:null;var s=t.type?t.type:"get";var o=t.position?t.position:"top";var l=e.requestTip({position:"center"});if(r){e.ajax({url:r,params:i,type:s,timeout:1e4,success:function(e){if(n){n(e)}switch(e.code){case"0":l.success(e.message);break;default:l.error(e.message);break}a.initButtonbar($(".ui-grid-buttonbar"))},beforeSend:function(){l.wait()},error:function(){l.error()}})}},setLocation:function(t,a){$(".ui-location ul").html("");var r={};var i=e.findParentToArray(t,a);if(i&&i.length>0){$(i).each(function(e,t){var a=document.createElement("li");$(a).html(t.label);$(".ui-location ul").append(a);if(e!=i.length-1){$(a).append("<i class='fa fa-angle-right'></i>")}})}},getStar:function(e){var t="";for(var a=1;a<=5;a++){if(a<=e){t+="<i class='light fa fa-star'></i>"}else{t+="<i class='fa fa-star'></i>"}}return t},loadPage:function(e){require(["app/mainApp"],function(t){t.loadPage(e)})},drawChart:function(t){var a={};a.chartContainer=t.chartContainer?t.chartContainer:null;a.chartOption=t.chartOption?t.chartOption:null;a.data=t.data?t.data:null;a.callback=t.callback?t.callback:null;a.draw=function(){a.setOption();e.highCharts({container:a.chartContainer,chartOption:a.chartOption,callback:a.callback})};a.setOption=function(){a.chartOption.series=a.data};a.draw()},arrayStrToNumber:function(e){var t=[];$(e).each(function(e,a){t.push(Number(a))});return t},setPanelButtonbar:function(){$(".ui-panel-buttonbar li").on("click",function(){$(this).parent().children("li").removeClass("active");$(this).addClass("active")})},setGridLinkGroup:function(){$(".ui-grid-linkGroup li").on("click",function(){$(this).parent().children("li").removeClass("active");$(this).addClass("active")})},mergeTreeData:function(e,t){var a={};var e=e;$(e).each(function(a,r){if(r.id==t){r.icon="../images/0.png";r.open=true;return true}else{var i=false;$(e).each(function(e,t){if(t.pid==r.id){r.icon="../images/2.png";r.open=true;i=true;return false}});if(i==false){r.icon="../images/4.png"}}});return e},gridFilter:function(t){var a=$.parseJSON(t);switch(a.code){case"0":a.recordsTotal=a.data.totalElements;a.recordsFiltered=a.data.totalElements;a.data=a.data.content;break;default:a.recordsTotal=0;a.recordsFiltered=0;a.data=[];var r=e.requestTip();r.error(a.message);break}return JSON.stringify(a)},gridFilters:function(t){var a=$.parseJSON(t);switch(a.code){case"0":a.recordsTotal=a.data.length;a.recordsFiltered=a.data.length;a.data=a.data;break;default:a.recordsTotal=0;a.recordsFiltered=0;a.data=[];var r=e.requestTip();r.error(a.message);break}return JSON.stringify(a)},gridPageFliter:function(e,a){e.page=e.start/e.length;e.size=a?a:t},getUserSession:function(e){e.setRequestHeader("Test","test")},getParams:function(t,r){a.gridPageFliter(t);var i=e.form.getParams($(r),true);if(i==""){i+="size="+t.size+"&page="+t.page}else{i+="&size="+t.size+"&page="+t.page}return i},getPostParams:function(t,r){a.gridPageFliter(t);var i=e.form.getParams($(r));if(i){$.extend(t,i)}return JSON.stringify(t)},initButtonbar:function(e){$(e).find(".add").show();$(e).find(".modify").removeClass("disabled").addClass("disabled");$(e).find(".delete").removeClass("disabled").addClass("disabled")},treeTable:function(t){var a={};a.tmpRow=null;a.dg=function(e){if(e&&e.length>0){$(e).each(function(e,r){var i=document.createElement("tr");$(i).attr("data-tt-id",r.id);$(i).attr("data-tt-parent-id",r.pid);$(i).addClass("ui-treeTableChild");var n="";$(t.aoColumns).each(function(e,t){var a=t.type?t.type:null;switch(a){case"checkbox":n+="<td><input type='checkbox' class='cb' name='cb' data-level='"+r.level+"' value='"+r[t.data]+"' pid='"+r.pid+"'/></td>";break;default:n+="<td>"+function(){return r[t.data]?r[t.data]:"--"}()+"</td>";break}});$(i).html(n);$(a.tmpRow).after(i);a.tmpRow=i;a.dg(r.children)})}};var r=t.json.data;$(r).each(function(e,r){if(r.children&&r.children.length>0){a.tmpRow=$(t.nTable).find("tbody tr[rootrow='"+e+"']");a.dg(r.children)}});e.treeTable({container:t.nTable,setting:{expandable:true}})},typeSelect:function(e){switch(e){case"12":return"文本";break;case"91":return"日期";break;case"3":return"数字";break;case"93":return"时间";break;case"4":return"整型";break}},getCookis:function(){var e=$.cookie("dssgUserInfo");if(e){e=JSON.parse(e)}return e},router:function(){},selectedTr:function(e){e.find("tbody").on("click","tr",function(){$("tbody tr").removeClass("selected");$(this).toggleClass("selected")})}};return a});