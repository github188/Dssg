define(["base","app/commonApp"],function(e,t){var a=null;var r={processing:true,serverSide:true,searching:false,ordering:false,lengthChange:false,pagingType:"full_numbers",ajax:{url:$.path+"/api/resFilterStrategy/findResFilterStrategyByPage",type:"get",contentType:"application/json",xhrFields:{withCredentials:true},data:function(a){t.gridPageFliter(a);var r=e.form.getParams("#search-form");var i;if(r){i=$.extend({page:a.page,size:a.size},r)}return i}},columns:[{data:"id",sWidth:"5%"},{data:"name",sWidth:"20%"},{data:"content",sWidth:"30%"},{data:"description",sWidth:"45%"}],columnDefs:[{render:function(e,t,a,r){return"<div class='checkboxWrapper'><input type='checkbox' name='cb' value='"+a.id+"' class='cb' cid='"+a.id+"'/></div>"},targets:0},{render:function(e,t,a,r){if(a.description){return a.description}else{return"--"}},targets:3}],drawCallback:function(a){e.selectAll($("#cball"),$(".cb"),function(){t.checkByGridButton($(".cb"))});t.selectedTr($("#keywords"))}};var i=function(){a=e.datatables({container:$("#keywords"),option:r,filter:t.gridFilter})};var n=function(){$(".ui-grid-buttonbar .add").on("click",function(){if(!$(this).hasClass("disabled")){l()}});$(".ui-grid-buttonbar .delete").on("click",function(){if(!$(this).hasClass("disabled")){d()}});$(".ui-grid-buttonbar .modify").on("click",function(){if(!$(this).hasClass("disabled")){o()}})};var c=function(){$("#search").on("click",function(){t.search(a)})};var s=function(){$("#reset").off().on("click",function(){t.reset($(this).parents(".ui-searchbar").find("form"),a)})};var l=function(){var r=e.modal({label:"新建策略",width:700,height:270,url:"../html/systemManage/keywordsFilter/create.html",drag:true,buttons:[{label:"保存",cls:"btn btn-info",clickEvent:function(){e.form.validate({form:$("#form"),checkAll:true,passCallback:function(){var i=e.form.getParams($("#form"));if(i){t.submit({url:$.path+"/api/resFilterStrategy/add",params:i,type:"post",callback:function(e){if(e.code==0){e.message="新建策略成功"}else{e.message="新建策略失败"}t.search(a)}});r.hide()}}})}},{label:"重置",cls:"btn btn-warning",clickEvent:function(){t.reset($("#form"))}}]})};var o=function(){var r=e.modal({label:"修改",width:700,height:270,url:"../html/systemManage/keywordsFilter/modify.html",drag:true,callback:function(){e.ajax({url:$.path+"/api/resFilterStrategy/get?id="+e.getCR("cb").attr("cid"),type:"get",success:function(t){if(t.code=="0"){var a=t.data;e.form.init(a,$("#form"));$("#form").find("input[name='code']").attr("disabled",true)}},error:function(e){}})},buttons:[{label:"保存",cls:"btn btn-info",clickEvent:function(){e.form.validate({form:$("#form"),checkAll:true,passCallback:function(){var i={id:e.getCR("cb").attr("cid")};var n=e.form.getParams($("#form"));var c=$.extend(n,i);if(c){t.submit({url:$.path+"/api/resFilterStrategy/update",params:c,type:"post",callback:function(e){if(e.code==0){e.message="保存成功"}else{e.message="保存失败"}t.search(a)}});r.hide()}}})}},{label:"重置",cls:"btn btn-warning",clickEvent:function(){t.reset($("#form"))}}]})};var d=function(){var r=e.getChecks("cb");e.confirm({confirmCallback:function(){t.submit({url:$.path+"/api/resFilterStrategy/delete",type:"post",params:r,callback:function(e){if(e.code==0){e.message="删除成功"}else{e.message="删除失败"}t.search(a)}})}})};var f=function(){e.scroll({container:$(".ui-gridbar")})};return{main:function(){i();n();c();s();f()}}});